<?xml version="1.0"?>
<!-- Copyright 2025 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->

<!--
  Advanced Panel - Advanced tools and emergency controls

  Features:
  - Emergency Controls section (E-Stop, Restart Klipper, Firmware Restart)
  - Future: Console, Macros, System Info
-->
<component>
  <view extends="lv_obj" name="advanced_panel"
        width="100%" height="100%"
        style_pad_all="#padding_normal"
        style_border_width="0"
        flex_flow="column"
        style_pad_gap="#gap_normal"
        scrollable="true" scroll_dir="ver">

    <!-- Emergency Controls Section -->
    <lv_obj width="100%" height="content"
            style_bg_opa="0" style_border_width="0"
            flex_flow="column"
            style_pad_gap="#gap_normal">

      <!-- Section Header -->
      <lv_obj width="100%" height="content"
              style_bg_opa="0" style_border_width="0"
              flex_flow="row"
              style_flex_cross_place="center"
              style_pad_gap="#gap_small">
        <icon src="mat_emergency" size="sm"
              style_image_recolor="#error_color" style_image_recolor_opa="255"/>
        <text_heading text="Emergency Controls"/>
      </lv_obj>

      <!-- Emergency Stop Button (prominent red) -->
      <lv_button name="advanced_estop_btn"
                 width="100%" height="#button_height_normal"
                 style_radius="#border_radius_large"
                 style_border_width="0"
                 style_bg_color="#error_color"
                 flex_flow="row"
                 style_flex_main_place="center"
                 style_flex_cross_place="center"
                 style_pad_gap="#gap_normal">
        <icon src="mat_emergency" size="md"
              style_image_recolor="#FFFFFF" style_image_recolor_opa="255"/>
        <text_body text="Emergency Stop (M112)" style_text_color="#FFFFFF"/>
        <event_cb trigger="clicked" callback="advanced_estop_clicked"/>
      </lv_button>

      <!-- Restart Buttons Row -->
      <lv_obj width="100%" height="content"
              style_bg_opa="0" style_border_width="0"
              flex_flow="row"
              style_pad_gap="#gap_normal">

        <!-- Restart Klipper Button -->
        <lv_button name="advanced_restart_klipper_btn"
                   flex_grow="1" height="#button_height_small"
                   style_radius="#border_radius"
                   style_border_width="0"
                   style_bg_color="#warning_color"
                   style_pad_ver="#button_padding"
                   flex_flow="row"
                   style_flex_main_place="center"
                   style_flex_cross_place="center"
                   style_pad_gap="#gap_small">
          <icon src="mat_refresh" size="sm"
                style_image_recolor="#FFFFFF" style_image_recolor_opa="255"/>
          <text_body text="Restart Klipper" style_text_color="#FFFFFF"/>
          <event_cb trigger="clicked" callback="advanced_restart_klipper_clicked"/>
        </lv_button>

        <!-- Firmware Restart Button -->
        <lv_button name="advanced_firmware_restart_btn"
                   flex_grow="1" height="#button_height_small"
                   style_radius="#border_radius"
                   style_border_width="0"
                   style_bg_color="#surface_bg_dark"
                   style_pad_ver="#button_padding"
                   flex_flow="row"
                   style_flex_main_place="center"
                   style_flex_cross_place="center"
                   style_pad_gap="#gap_small">
          <icon src="mat_update" size="sm"
                style_image_recolor="#text_secondary" style_image_recolor_opa="255"/>
          <text_body text="Firmware Restart" style_text_color="#text_secondary"/>
          <event_cb trigger="clicked" callback="advanced_firmware_restart_clicked"/>
        </lv_button>
      </lv_obj>

      <!-- Help Text -->
      <text_small text="Emergency Stop immediately halts all motion. Restart Klipper performs a soft restart. Firmware Restart fully resets the MCU."
                  long_mode="wrap"
                  style_text_color="#text_muted"
                  width="100%"/>
    </lv_obj>

    <!-- Divider -->
    <lv_obj width="100%" height="1"
            style_bg_color="#card_border" style_bg_opa="128"
            style_border_width="0"/>

    <!-- Placeholder for future features -->
    <lv_obj width="100%" height="content"
            style_bg_opa="0" style_border_width="0"
            flex_flow="column"
            style_pad_gap="#gap_normal">

      <!-- Section Header -->
      <lv_obj width="100%" height="content"
              style_bg_opa="0" style_border_width="0"
              flex_flow="row"
              style_flex_cross_place="center"
              style_pad_gap="#gap_small">
        <icon src="mat_fine_tune" size="sm"
              style_image_recolor="#text_secondary" style_image_recolor_opa="255"/>
        <text_heading text="Advanced Features"/>
      </lv_obj>

      <text_body text="More advanced features coming soon:"
                 style_text_color="#text_secondary"/>

      <text_small text="G-code Console, Macro Editor, System Information, Debug Tools"
                  long_mode="wrap"
                  style_text_color="#text_muted"
                  width="100%"/>
    </lv_obj>

  </view>
</component>
